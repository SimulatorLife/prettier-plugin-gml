name: "Agent 38 - Logic Deduplication"
on:
  workflow_dispatch:
    inputs:
      agent:
        description: "Optional agent override."
        required: false
        default: ""
        type: string

permissions:
  contents: write
  pull-requests: write
  issues: write

jobs:
  run:
    uses: ./.github/workflows/_agent-open-pr-and-ping.yml
    secrets: inherit
    with:
      agent: ${{ inputs.agent }}
      pr_title: "Agent: Logic Deduplication"
      prompt: >
        Hunt for duplicated conditionals, switch statements, or near-identical helper
        bodies that drift across the codebase. Select one small cluster and unify it by
        extracting a shared helper, reusing an existing one, or routing both code paths
        through the same implementation. When extracting something new, strongly prefer
        helpers that will see at least three call sites and hold five or more lines of
        executable logic (excluding comments and blank lines), unless you have a clear
        justification to diverge. Avoid expanding scopeâ€”focus on a single, well-understood
        duplication, keep naming and APIs stable, and add/regress tests as needed so the
        unified path stays safe. In your commit message, call out where the duplication
        lived and the helper/path that now covers it.
