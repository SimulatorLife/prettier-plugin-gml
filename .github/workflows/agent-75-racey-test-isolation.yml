name: Agent 75 â€“ Racey Test Isolation
on:
  workflow_dispatch:
    inputs:
      agent:
        description: "Optional agent override."
        required: false
        default: ""
        type: string

permissions:
  contents: write
  pull-requests: write
  issues: write

jobs:
  run:
    uses: ./.github/workflows/_agent-open-pr-and-ping.yml
    secrets: inherit
    with:
      agent: ${{ inputs.agent }}
      pr_title: "Agent: Racey Test Isolation"
      prompt: >
        Identify a test known to be flaky (shared globals, timing reliance,
        leaking timers, real network calls) and refactor it for determinism. Apply fixes such as
        per-test fixtures, mocked-APIs, better teardown, explicit waits, or fake timers, and
        include evidence (failing reproduction or reasoning) that the old test
        flaked. Keep the scope tight by focusing on one flaky scenario and
        ensuring the suite now runs reliably.
