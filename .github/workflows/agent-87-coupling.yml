name: "Agent 87 â€“ Low Coupling Guardrail"

on:
  workflow_dispatch:
    inputs:
      agent:
        description: "Optional agent override."
        required: false
        default: ""
        type: string

permissions:
  contents: write
  pull-requests: write
  issues: write

jobs:
  run:
    uses: ./.github/workflows/_agent-open-pr-and-ping.yml
    secrets: inherit
    with:
      agent: ${{ inputs.agent }}
      pr_title: "Agent: Low Coupling Guardrail"
      prompt: >
        Audit the repository for modules that import peers using deep relative paths
        ("../.." or deeper) or paths containing "/internal/" segments. For each finding,
        cite the file and import statement, explain why the coupling is risky, and
        recommend an appropriate abstraction (interface, adapter, factory, or public
        facade) that would let the consumer depend on stable contracts rather than
        implementation details. Prefer imports of module's public API 
        (e.g. `import { Core } from "@gml-modules/core";`) over deep relative paths 
        or overly-complex dependency injection. Where improvements are tractable, 
        implement the minimal changes needed to introduce the abstraction, update 
        imports, and keep behaviour identical.
