name: "Agent 21 - Extensibility Hooks"
on:
  workflow_dispatch:
    inputs:
      agent:
        description: "Optional agent override."
        required: false
        default: ""
        type: string

permissions:
  contents: write
  pull-requests: write
  issues: write

jobs:
  run:
    uses: ./.github/workflows/_agent-open-pr-and-ping.yml
    secrets: inherit
    with:
      agent: ${{ inputs.agent }}
      pr_title: "Agent: Add Extensibility Hook"
      prompt: >
        Identify a single hard-coded decision point that limits flexibility *or* 
        detect an existing over-engineered extensibility anti-pattern and 
        refactor it back to a simpler, opinionated default. Perform a
        concise pre-change analysis describing current behavior, the rationale
        for change, and the impact on defaults.
        
        If adding a new seam:
        - Refactor it into a configurable, parameterized, or hookable mechanism
          that remains opinionated and straightforward to extend.
        - Avoid overgeneralization: the change should solve one concrete
          extensibility gap without introducing unnecessary abstraction or complexity.
        - When you add a hook or configuration point, document the default
          behavior, the intended consumers, and how it should evolve over time.
        - Keep the implementation minimal, update any directly affected docs or
          inline comments, and ensure tests and linters still pass.

        If fixing an anti-pattern:
        - Remove unnecessary user-facing configuration or fallback mechanisms.
        - Collapse redundant abstractions into a single, well-defined behavior.
        - Preserve intended use cases if/where applicable or required while 
          reducing surface area and complexity.
        - Update inline comments and docs to clearly state the expected default
          and why configurability-bloat was removed.
        - Verify that tests still pass under the simplified, opinionated default.

        ## **BAD** Extensibility Examples

        * **Do not** add an end-user option for custom file extensions in a GML parser.
        Supporting arbitrary extensions like “.gmlx” or “.foo” creates needless surface area and confusion. The parser should only ever handle .gml. Any configurability here just bloats code and dilutes purpose.
        * **Do not** include a fallback custom XML parser if the required XML library is missing.
        This doubles maintenance and behavior variance. The proper fix is to ensure dependency resolution at install or build time, not duplicate functionality inside your project.
        * **Do not** introduce a general “strategy” or “plugin” system for a single rigid branch.
        Turning one fixed if/else into a generic framework leads to abstraction creep. Add only a narrow seam where flexibility is genuinely needed.
        * **Do not** expose internal toggles as runtime configuration (env vars, CLI flags, etc.).
        Developer-facing switches should stay private. End users should never see or need to set them; use internal hooks or parameters instead.
        * **Do not** implement autodetection for formats the tool already controls. For example, if the system already mandates .gml and UTF-8, there is no value in guessing encoding or line endings. Keep expectations strict and predictable.
