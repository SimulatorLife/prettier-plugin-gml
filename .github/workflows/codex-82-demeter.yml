name: Codex 82 â€“ Law of Demeter Guardrails
on:
  repository_dispatch:
    types: [run_scheduled]
  - cron: "7 6 3-31/4 * *"  # every four days at 06:07 UTC (days 3,7,...)
  workflow_dispatch:

permissions:
  contents: write
  pull-requests: write
  issues: write

jobs:
  run:
    if: ${{ (github.event_name == 'workflow_dispatch' || (github.event_name == 'repository_dispatch' && github.event.action == 'run_scheduled' && github.event.client_payload.workflow_file == '.github/workflows/codex-82-demeter.yml')) }}
    uses: ./.github/workflows/_codex-open-pr-and-ping.yml
    secrets: inherit
    with:
      pr_title: "Codex: Law of Demeter Guardrails"
      pr_body: |
        Seed PR for Codex to rein in long-reaching property access and reinforce the
        Law of Demeter across the codebase.
      prompt: >
        Search the repository for property chains longer than three segments (for example,
        patterns like `alpha.beta.gamma.delta`). Highlight the exact lines you choose in your
        summary so reviewers can see the high-risk chains that motivated the work. Refactor the
        most compelling instance by introducing intermediate helpers, facades, or other seams so
        collaborators only talk to their immediate neighbours. Keep the fix tightly scoped,
        document any new helper surfaces, and make sure existing tests still pass.
